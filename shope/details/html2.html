<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/shope.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-app.js"></script>
    <script src='https://www.gstatic.com/firebasejs/3.1.0/firebase-database.js'></script>
    <script src="../js/shopepaiment.js"></script>
</head>
    <body>
      <main>
        <section id="passWindows">
          <div id="bar">
            <center>
            <div class="bar" style="background-color: blue;"></div>
            <span style="font-size: 18px; font-weight: bold; width: 100%; padding: 0.3em;">Details sur le produit</span>
            <div class="bar" style="background-color: blue;"></div>
            </center>
          </div><!--bar de titre de detaills-->
          <img src="../images/ibi.png">
                      <h1>Introduction à la B.I. 
                        Avec SQL Server 2008</h1>
                      <p>
                        <strong>Sommaire</strong><br>
                        1 Présentation de la B.I. et SQL Server 2008<br>
                        1.1 Présentation rapide de SQL Server 2008<br>
                        1.2 La B.I. : définition et apport à l’entreprise<br>
                        2 Le datawarehouse<br>
                        2.1 Définition du datawarehouse<br>
                        2.2 Conception du datawarehouse<br>
                        3 Premières notions d’Integration Services
                      </p>
                      <center><button class="btn" onclick="acheterPass()">Acheter ce produit</button></center>
        </section> <!--section de detail-->

        <section id="formPass">
          <div class="form" >
            <div class="h1"><h1>Introduction à la B.I. </h1></div>
              <center>
                <div class="prix">
                  <p>Payer</p><input id="prix" value="450" disabled><p>Rm</p>
                </div>
                <hr/>
                <p id="msg">
                  Bienvnue
                </p>
                <div class="g">
                    <div class="balance">
                      <input type="password" class="input"  id="number" placeholder="Entrer votre pin ici">
                      <button id="select" class="w3-btn w3-blue">balance</button>
                    </div>
                </div>
                  <div id="myProgress">
                      <div id="myBar"></div>
                  </div>
                  <div class="groupe">
                    <p>Vous avez</p>
                    <input type="montant" id="montant" disabled>
                    <p>Rm dispo</p>
                  </div>
                <div class="bar-btn">
                  <button type="submit" id="payer" class="w3-btn w3-blue">Payer votre produit</button>
                </div>
              </center>
          </div>
        </section> <!--section de paiment-->
      </main>
          <script>
            // Your web app's Firebase configuration
            var firebaseConfig = {
              apiKey: "AIzaSyDVjzbTqXNzNsteN9FtUnLzG7J9G1h-Pkg",
              authDomain: "signup-de54d.firebaseapp.com",
              databaseURL: "https://signup-de54d.firebaseio.com",
              projectId: "signup-de54d",
              storageBucket: "signup-de54d.appspot.com",
              messagingSenderId: "313335894880",
              appId: "1:313335894880:web:367bf0a26531cbd0f1c405",
              measurementId: "G-TX374HDPKS"

            };
            // Initialize Firebase
            firebase.initializeApp(firebaseConfig);
            
            // Database reference 
            var numberV, montantV, prix;
            
            function Ready(){
            numberV = document.getElementById('number').value;
            montantV = document.getElementById('montant').value;
            }
            //...........................select data.........................
            document.getElementById('select').onclick = function(){
            if(numberV ==""){
            document.getElementById('msg').innerHTML="Veuillez entrer votre pin";
            }else{
            
            Ready();
            firebase.database().ref(numberV).on('value',function(snapshot){;
            document.getElementById('montant').value= snapshot.val().BALANCE;
            document.getElementById("select").disabled = true;
            document.getElementById("insert").disabled = false;
            });
            }
            }
            
            document.getElementById('payer').addEventListener('click', function(){
            numberV = document.getElementById('number').value;
            montantV = document.getElementById('montant').value;
            var prix = document.getElementById('prix').value;
            var price = 450;
            var i = 0;
            if(montantV > price){
              firebase.database().ref(numberV).update({
              NUMBER: numberV,
              BALANCE: montantV - price,
            })
            if (i == 0) {
                i = 1;
                var elem = document.getElementById("myBar");
                var width = 1;
                var id = setInterval(frame, 10);
                function frame() {
                if (width >= 100) {
                clearInterval(id);
                document.getElementById('montant').value = '';
                document.getElementById('number').value = '';
                window.location.assign("https://drive.google.com/uc?export=download&id=1t1wsN3z_BG_WkaImKn-Kz1XXf7I_vqze");
                i = 0;
                } else {
                width++;
                elem.style.width = width + "%";
                }
                }
                }
            } else{
              document.getElementById('msg').innerHTML = "Vous n'avez pas assez de Rm"; 
            
            }
            
            });
            // The click Event
          
          </script>
    </body>
</html>